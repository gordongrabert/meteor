<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MeTEor">
<title>MeTEor Preprocessing steps • MeTEor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MeTEor Preprocessing steps">
<meta property="og:description" content="MeTEor">
<meta property="og:image" content="https://scibiome.github.io/meteor/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MeTEor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Covid_data.html">MeTEor-Covid data</a>
    <a class="dropdown-item" href="../articles/Example_data.html">MeTEor-Example data</a>
    <a class="dropdown-item" href="../articles/Tutorial.html">UNKNOWN TITLE</a>
    <a class="dropdown-item" href="../articles/preprocess_raw_data.html">MeTEor Preprocessing steps</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/scibiome/meteor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>MeTEor Preprocessing steps</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/scibiome/meteor/blob/HEAD/vignettes/preprocess_raw_data.Rmd" class="external-link"><code>vignettes/preprocess_raw_data.Rmd</code></a></small>
      <div class="d-none name"><code>preprocess_raw_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="library">Library<a class="anchor" aria-label="anchor" href="#library"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statistikat/VIM" class="external-link">VIM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">laeken</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scibiome.github.io/meteor/">MeTEor</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>In the first step load unprocessed data set “raw_example_data”. This
data set represents a sample of metabolomic data and exhibits common
issues such as missing values and duplicates. Additionally, the current
format does not adhere to the specifications required by MeTEor.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in CSV file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"raw_example_data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">raw_example_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;      id treatment   sex  comp metabolite_1 metabolite_2  time metabolite_3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1         0     0     1        1.88         0.750     1       -<span style="color: #BB0000;">2.23</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1         0     0     1        2.22        -<span style="color: #BB0000;">0.167</span>     2       -<span style="color: #BB0000;">1.05</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1         0     0     1        1.85         0.221     3       -<span style="color: #BB0000;">0.681</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1         0     0     1        0.339        1.94      4       -<span style="color: #BB0000;">2.36</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1         0     0     1        1.16         1.20      5       -<span style="color: #BB0000;">2.54</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preprocessing-steps">Preprocessing steps:<a class="anchor" aria-label="anchor" href="#preprocessing-steps"></a>
</h2>
<div class="section level3">
<h3 id="remove-duplicate-cases-">Remove duplicate cases.<a class="anchor" aria-label="anchor" href="#remove-duplicate-cases-"></a>
</h3>
<p>The first step is to check whether duplicate cases are contained in
the data record. If this is the case, these can be removed from the data
set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check if the data contains duplicates</span></span>
<span><span class="va">duplicated_rows</span> <span class="op">&lt;-</span> <span class="va">raw_example_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">raw_example_data</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># drop duplicates</span></span>
<span><span class="va">raw_example_data</span> <span class="op">&lt;-</span> <span class="va">raw_example_data</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">raw_example_data</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">raw_example_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;      id treatment   sex  comp metabolite_1 metabolite_2  time metabolite_3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1         0     0     1        1.88         0.750     1       -<span style="color: #BB0000;">2.23</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1         0     0     1        2.22        -<span style="color: #BB0000;">0.167</span>     2       -<span style="color: #BB0000;">1.05</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1         0     0     1        1.85         0.221     3       -<span style="color: #BB0000;">0.681</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1         0     0     1        0.339        1.94      4       -<span style="color: #BB0000;">2.36</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1         0     0     1        1.16         1.20      5       -<span style="color: #BB0000;">2.54</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reordering-and-dropping-irrelevant-columns-">Reordering and dropping irrelevant columns.<a class="anchor" aria-label="anchor" href="#reordering-and-dropping-irrelevant-columns-"></a>
</h3>
<p>If the data set contains columns that are irrelevant for further
analysis, these can be removed from the data set.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># reorder columns</span></span>
<span><span class="va">raw_example_data</span> <span class="op">&lt;-</span> <span class="va">raw_example_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="st">"time"</span>, .before <span class="op">=</span> <span class="st">"metabolite_1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># drop column measurement_complete since it is not used</span></span>
<span><span class="va">raw_example_data</span> <span class="op">&lt;-</span> <span class="va">raw_example_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">comp</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">raw_example_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;      id treatment   sex  time metabolite_1 metabolite_2 metabolite_3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1         0     0     1        1.88         0.750       -<span style="color: #BB0000;">2.23</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1         0     0     2        2.22        -<span style="color: #BB0000;">0.167</span>       -<span style="color: #BB0000;">1.05</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1         0     0     3        1.85         0.221       -<span style="color: #BB0000;">0.681</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1         0     0     4        0.339        1.94        -<span style="color: #BB0000;">2.36</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1         0     0     5        1.16         1.20        -<span style="color: #BB0000;">2.54</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: metabolite_4 &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="checking-data-types-">Checking data types.<a class="anchor" aria-label="anchor" href="#checking-data-types-"></a>
</h3>
<p>For the analysis in MeTEor, it is important that metabolite values
are variables of the “numeric” type. The “time” variable should also be
a variable of the type “numeric” or “integer”. The categorical variables
can be of different data types.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check if all data is numeric</span></span>
<span><span class="va">non_numeric_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">raw_example_data</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">raw_example_data</span>, <span class="va">is.numeric</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># transform to numeric</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="va">raw_example_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span><span class="va">is.character</span>, <span class="va">as.numeric</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select the numeric columns you want to scale</span></span>
<span><span class="va">columns_to_scale</span> <span class="op">&lt;-</span> <span class="fl">5</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scale the selected numeric columns</span></span>
<span><span class="va">cleaned_data</span><span class="op">[</span>, <span class="va">columns_to_scale</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">[</span>, <span class="va">columns_to_scale</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;      id treatment   sex  time metabolite_1 metabolite_2 metabolite_3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1         0     0     1        1.88         0.739       -<span style="color: #BB0000;">2.23</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1         0     0     2        2.23        -<span style="color: #BB0000;">0.175</span>       -<span style="color: #BB0000;">1.05</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1         0     0     3        1.85         0.211       -<span style="color: #BB0000;">0.682</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1         0     0     4        0.340        1.93        -<span style="color: #BB0000;">2.36</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1         0     0     5        1.16         1.19        -<span style="color: #BB0000;">2.54</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: metabolite_4 &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="section"></h3>
</div>
<div class="section level3">
<h3 id="imputation">Imputation<a class="anchor" aria-label="anchor" href="#imputation"></a>
</h3>
<p>The dataset contains missing values, which need to be addressed
before conducting analysis in MeTEor. Initially, it’s crucial to
identify metabolites with missing data. Some metabolites may exhibit a
higher prevalence of missing values. For instance, metabolites with more
than 10% missing values can be filtered out initially. Subsequently, for
the remaining missing values, techniques like k-nearest neighbor
imputation can be employed to impute the missing data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Find columns with missing values</span></span>
<span><span class="va">columns_with_missing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">columns_with_missing</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "metabolite_1"  "metabolite_2"  "metabolite_5"  "metabolite_8" </span></span>
<span><span class="co">#&gt; [5] "metabolite_35" "metabolite_36"</span></span>
<span></span>
<span><span class="co"># Remove columns with more than 10% NA</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="va">cleaned_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># impute columns using KNN</span></span>
<span><span class="va">data_meta_imputed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VIM/man/kNN.html" class="external-link">kNN</a></span><span class="op">(</span><span class="va">cleaned_data</span>, numFun <span class="op">=</span> <span class="va">weightedMean</span>, weightDist<span class="op">=</span><span class="cn">TRUE</span>, imp_var <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_meta_imputed</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id treatment sex time metabolite_1 metabolite_2 metabolite_3 metabolite_4</span></span>
<span><span class="co">#&gt; 1  1         0   0    1    1.8823324    0.7392192    -2.234135    0.3125514</span></span>
<span><span class="co">#&gt; 2  1         0   0    2    2.2290461   -0.1754409    -1.050501   -0.1804359</span></span>
<span><span class="co">#&gt; 3  1         0   0    3    1.8537748    0.2114429    -0.682141    0.4196308</span></span>
<span><span class="co">#&gt; 4  1         0   0    4    0.3397636    1.9275903    -2.360588    0.3767579</span></span>
<span><span class="co">#&gt; 5  1         0   0    5    1.1591128    1.1860050    -2.543155    1.0149524</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="change-data-format">Change data format<a class="anchor" aria-label="anchor" href="#change-data-format"></a>
</h3>
<p>The data format is being transformed from wide to long format to make
it compatible with MeTEor. This also involves reorganizing the columns
to ensure that the dataset is structured appropriately.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_meta_imputed_long</span> <span class="op">&lt;-</span> <span class="va">data_meta_imputed</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"time"</span>, <span class="st">"sex"</span>, <span class="st">"treatment"</span><span class="op">)</span>, </span>
<span>                                           names_to <span class="op">=</span> <span class="st">"metabolites"</span>, values_to <span class="op">=</span> <span class="st">"values"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">time</span>, .after <span class="op">=</span> <span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">sex</span>, .after <span class="op">=</span> <span class="va">values</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">treatment</span>, .after <span class="op">=</span> <span class="va">values</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_meta_imputed_long</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;      id  time metabolites  values treatment   sex</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     1 metabolite_1  1.88          0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     1 metabolite_2  0.739         0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1     1 metabolite_3 -<span style="color: #BB0000;">2.23</span>          0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1     1 metabolite_4  0.313         0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1     1 metabolite_5 -<span style="color: #BB0000;">0.198</span>         0     0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="export-data-set">Export data set<a class="anchor" aria-label="anchor" href="#export-data-set"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">data_meta_imputed_long</span>, file <span class="op">=</span> <span class="st">"data_long.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Grabert Gordon, Dehncke Daniel, More Tushar, List Markus, Kraft Anke RM, Cornberg Markus, Hiller Karsten, Kacprowski Tim, <a href="https://www.compsysmed.de/" class="external-link"><img src="https://www.compsysmed.de/media/scibiome_logo_hu28c98603dd3cc7d737f50751fffabc22_54234_1200x0_resize_lanczos_3.png" alt="scibiome" height="120" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
